---
title: Monitoring System
description: Error tracking and application monitoring with Rollbar integration
---

import { Callout } from 'fumadocs-ui/components/callout'

# Monitoring System

A complete error monitoring solution based on Rollbar, covering both browser and server, with React integration and context tracking.

<Callout type="info">
The system automatically captures unhandled errors and provides manual reporting and context settings.
</Callout>

> Client hooks live in `src/hooks/use-monitoring.ts`. Browser/server SDK wrappers are in `src/components/monitoring/`.

## Key Features

### Automatic Capture (＾▽＾)
- Uncaught JS exceptions
- Unhandled Promise rejections
- React component errors
- Server-side exceptions

### Manual Reporting (・ω・)
```ts
const { captureError, captureMessage } = useMonitoring()
captureError(new Error('Something went wrong'), { user_action: 'form_submit' })
captureMessage('User performed action', 'info', { action: 'button_click' })
```

### User Context (￣▽￣)
```ts
const { setUser } = useMonitoring()
setUser({ id: 'user_123', email: 'user@example.com', username: 'johndoe' })
```

### Custom Context (・∀・)
```ts
const { setContext } = useMonitoring()
setContext('current_page', '/dashboard')
setContext('feature_flags', { newUI: true })
```

## Setup and Configure

<div className="fd-steps">
  <div className="fd-step">
    ### 1) Add environment variables
    In `.env` / Vercel envs add tokens:
    ```bash
    NEXT_PUBLIC_ROLLBAR_ACCESS_TOKEN=your_client_token
    ROLLBAR_SERVER_ACCESS_TOKEN=your_server_token
    ```
    <Callout type="warning">Use different tokens for client and server.</Callout>
  </div>
  <div className="fd-step">
    ### 2) Mount the client tracker
    Render `<Monitoring />` (exports RollbarAnalytics) near the root layout once.
  </div>
  <div className="fd-step">
    ### 3) Use hooks in the app
    Import from `@/hooks/use-monitoring` to report errors/messages and set user/context.
  </div>
  <div className="fd-step">
    ### 4) Server utilities
    For API/Route Handlers, use `serverCaptureError/serverCaptureMessage` from `@/components/monitoring/rollbar-server-monitoring`.
  </div>
  <div className="fd-step">
    ### 5) Verify
    Trigger a test error and confirm it appears in Rollbar.
  </div>
</div>

## Logging Levels and Examples

```ts
const events = useMonitoringEvents()
events.critical('Database connection failed', { database: 'primary' })
events.error('Payment processing failed', { payment_id: 'pay_123' })
events.warn('API rate limit approaching', { current_usage: 950, limit: 1000 })
events.info('User feature usage', { feature: 'advanced_search' })
events.debug('Component render details', { component: 'UserProfile' })
```

## Integration with Error Boundaries

```tsx
export class ErrorBoundary extends Component<Props, State> {
  componentDidCatch(error: Error, errorInfo: any) {
    captureError(error, { error_boundary: 'GlobalErrorBoundary', component_stack: errorInfo.componentStack })
  }
}
```

## Best Practices

- Set user and context in critical paths to improve troubleshooting efficiency.
- Sanitize request headers and sensitive data on the server before reporting.
- Combine with the analytics system to record key actions and close the loop.

## FAQ

**Q: Client-side reports are missing but there are no console errors?**  
**A:** Confirm `NEXT_PUBLIC_ROLLBAR_ACCESS_TOKEN` is configured; the browser SDK initializes only when this token exists. Also check network blockers/ad filters (＾_＾).

**Q: How to avoid leaking sensitive data on the server?**  
**A:** Sanitize headers and bodies before reporting; keep only necessary fields. You can pass sanitized data in `serverCaptureError` context (・ω・).

**Q: How to identify users or sessions?**  
**A:** After login call `setUser({ id, email, username })`. On logout, clear/reset the user context to avoid cross-session issues (￣ー￣).

**Q: How to consistently handle React component errors?**  
**A:** Wrap the root or critical regions with an error boundary, and call `captureError` in `componentDidCatch` with `component_stack` (＾▽＾).
