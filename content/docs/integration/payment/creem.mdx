---
title: Creem 支付集成
description: VibeAny支持多种支付平台，包括Stripe和Creem，但您只能选择一种进行配置。
---

由于 Creem 和 Stripe 存在诸多差异，VibeAny 内部磨平了 Stripe 和 Creem 的差异。

## 基础设置
<div className="fd-steps">
  <div className="fd-step">
    ### 创建Creem账号
    [Creem官网](https://creem.io/)
  </div>
  <div className="fd-step">
    ### 获取API密钥
    - 点击 `Developers`, 进入[开发者中心](https://www.creem.io/dashboard/developers)
    - 复制API密钥（注意：密钥测试模式以 creem_test_ 开头，生产模式以 creem_ 开头）
    - 将其保存到 .env 文件中作为 CREEM_X_API_KEY
    ### 获取 生产环境的 webhook 密钥
     <Callout type="warn">
     如果您还没有域名且没有部署，可以先使用测试环境，后续再配置生产环境，且建议本地测试后再配置生产环境
    </Callout>
    - 点击 `Webhooks`, 进入[Webhooks](https://www.creem.io/dashboard/webhooks)
    - 复制Webhook密钥，如果没有，则创建一个
    - 将其保存到 .env 文件中作为 CREEM_WEBHOOK_SECRET
    ### 获取 测试环境的 webhook 密钥
    Creem 和 Stripe 不同的是，Creem 的 webhook 需要回调到一个线上的 https 地址，因此Creem 测试环境的的 webhook 需要您对本地的 webhook 进行代理，您可以使用 ngrok 等工具创建到本地主机服务器的隧道，然后使用隧道的地址作为 webhook 的回调地址。
    - 安装 [ngrok](https://ngrok.com/docs/getting-started/)
    - 运行 ngrok，并代理本地服务器的端口
    ```bash
     ngrok http --url=resolved-game-sparrow.ngrok-free.app 3355
    ```
    - 点击 `Webhooks`, 进入[Webhooks](https://www.creem.io/dashboard/webhooks)
    - 配置 webhook 的回调地址，使用 ngrok 的地址`your-ngrok-url/api/payment/webhook`
    - 复制Webhook密钥
    - 将其保存到 .env 文件中作为 CREEM_WEBHOOK_SECRET

    <Callout type="warn">
     由于 Creem 的测试和生产环境是不同的 URL，因此，您还需要手动配置CREEM_TEST_MODE环境变量来切换模式
     ```bash
     CREEM_TEST_MODE=true // 为 true 时，使用测试环境
     CREEM_TEST_MODE=false // 为 false 时，使用生产环境
     ```
    </Callout>

    对于更多测试环境的webhook配置，可以参考 [Creem Webhook](https://docs.creem.io/learn/webhooks/introduction)。

  </div>
</div>


## 网站设置
在配置完基础的设置后，您需要开启支付功能，并配置支付计划。

```tsx title="src/config/core/website-config.tsx"
payment: {
  enabled: true,
  provider: "creem",
},
```

其中，provider 为 creem，enabled 为 true。

默认情况下，VibeAny 提供了免费计划、 pro 订阅计划、 lifetime 一次性计划，您可以根据需要进行配置。

```tsx title="src/config/core/website-config.tsx"
 planWithPrice: [
    {
      id: "free",
      planType: PlanTypes.FREE,
      prices: [],
    },
    {
      id: "pro",
      planType: PlanTypes.SUBSCRIPTION,
      prices: [
        {
          type: PaymentTypes.SUBSCRIPTION,
          priceId: process.env.NEXT_PUBLIC_CREEM_PRO_MONTHLY_PRICE_ID!,
          amount: 990,
          currency: "USD",
          interval: PlanIntervals.MONTH,
        },
        {
        type: PaymentTypes.SUBSCRIPTION,
          priceId: process.env.NEXT_PUBLIC_CREEM_PRO_YEARLY_PRICE_ID!,
          amount: 9990,
          currency: "USD",
          interval: PlanIntervals.YEAR,
        },
      ],
      recommended: true,
    },
    {
      id: "lifetime",
      planType: PlanTypes.LIFETIME,
      prices: [
        {
          type: PaymentTypes.ONE_TIME,
          priceId: process.env.NEXT_PUBLIC_CREEM_LIFETIME_PRICE_ID!,
          amount: 19900,
          currency: "USD",
        },
      ],
    },
  ],
```

## 测试卡
在测试环境下，你不必使用真实的卡号，可以使用测试卡号进行测试。

- `4242 4242 4242 4242`

更多可以参考 [Creem 测试模式](https://docs.creem.io/test-mode)。


## Q&A
### 如何设置微信和支付宝
Creem 不支持微信和支付宝支付，只支持如下的支付方式：
- Credit Cards
- Apple Pay
- Bancontact
- Blik
- Cartes Bancaires
- EPS
- Google Pay
- IDEAL
- Link
- MobilePay

详细可以参考 [Creem 支付方式](https://docs.creem.io/finance/payments)。
