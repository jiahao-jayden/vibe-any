---
title: 数据库
description: VibeAny 使用 Drizzle 作为 ORM，支持任何 PostgreSQL 数据库。
---

## 基础配置
在 `.env` 文件中配置数据库连接 URL，目前，VibeAny 只支持 PostgreSQL 数据库。例如：
```bash
DATABASE_URL=postgresql://username:password@localhost:5432/database
```

我们将为你演示多个平台的 PostgreSQL 数据库连接，您可以选择任意一个平台进行连接。

## 数据库连接
### Supabase

<div className="fd-steps">
  <div className="fd-step">
    #### 创建Supabase数据库
   登录 [Supabase 控制台](https://supabase.com/dashboard/organizations)，创建数据库
   #### 获取数据库连接 URL
   - 点击 `Connect`
    ![](/docs/intergration/database/supabase-connect.avif)
   - 点击`ORMs` > `Tool` > `Drizzle`
    ![](/docs/intergration/database/supabase-url.avif)
   - 会得到一个类似这样的连接 URL，将其保存到 .env 文件中作为 DATABASE_URL
    <Callout type="warn">
    [YOUR-PASSWORD] 需要替换成你在创建数据库时设置的密码, 请注意，连接 URL 中包含密码，请不要泄露给他人
    </Callout>
    ```bash
    DATABASE_URL="postgresql://postgres.xxxxxx:[YOUR-PASSWORD]@aws-1-ap-southeast-1.pooler.supabase.com:6543/postgres" // 这是示例链接，请以自己控制台得到的链接为准
    ```
  </div>
</div>


### Neon
<div className="fd-steps">
  <div className="fd-step">
    #### 创建Neon数据库
   登录 [Neon 控制台](https://neon.tech/)，创建数据库
  </div>
  <div className="fd-step">
    #### 获取数据库连接 URL
    - 点击 `Connect`
    ![](/docs/intergration/database/neon-connect.avif)
    - 复制`Connection String`
    ![](/docs/intergration/database/neon-url.avif)
    - 将其保存到 .env 文件中作为 DATABASE_URL
    ```bash
    DATABASE_URL=your-connection-string
    ```
  </div>
</div>

### Zeabur
<div className="fd-steps">
  <div className="fd-step">
    #### 创建Zeabur数据库
   登录 [Zeabur 控制台](https://zeabur.com/dashboard)，创建一个项目，并选择`Database` > `PostgreSQL`作为新的 Services
    ![](/docs/intergration/database/zeabur-create-db.avif)
   #### 获取数据库连接 URL
   等待几秒后，Services 会帮你创建好数据库，点击 `Overview`，下方的 `Instructions`中可以直接复制`Connection String`
   ![](/docs/intergration/database/zeabur-url.avif)
   - 将其保存到 .env 文件中作为 DATABASE_URL
   ```bash
   DATABASE_URL=your-connection-string
   ```
  </div>
</div>



## 初始化数据库
在完成数据库的配置连接后，您需要对数据库进行初始化，以确保数据库的正常使用。

是用该命令，Drizzle 会执行迁移文件`drizzle/`目录下的迁移文件，帮你初始化好数据库
<CommandTab code="run db:migrate" />

<Callout type="warn">
  如果您的数据库已经存在表结构，请谨慎使用该命令，建议手动进行应用
</Callout>

### 更新数据库
如果您修改了本地数据库的 schema 文件，您可以使用该命令更新数据库
 <CommandTab code="run db:push" />

您可以修改`src/db/schema.ts`文件，修改后更新数据库，schema 文件的编写可以参考[Drizzle 文档](https://orm.drizzle.team/docs/column-types/pg)


### 管理（可视化）数据库
使用该命令，您可以可视化地管理数据库，查看表结构，执行 SQL 语句等，终端会出现一个 URL，点击进入即可`https://local.drizzle.studio`

<CommandTab code="run db:studio" />

![](/docs/intergration/database/drizzle-studio.avif)


更多使用方法请参考 [Drizzle 文档](https://orm.drizzle.team/docs/overview)



## Q&A

### npx drizzle-kit push 报错

```
npx drizzle-kit push
No config path provided, using default 'drizzle.config.ts'
Reading config file '/Users/jayden/code/boost-any/drizzle.config.ts'
Using 'postgres' driver for database querying
[⣯] Pulling schema from database...
/Users/jayden/code/boost-any/node_modules/drizzle-kit/bin.cjs:19501
              checkValue = checkValue.replace(/^CHECK\s*\(\(/, "").replace(/\)\)\s*$/, "");
                                      ^

TypeError: Cannot read properties of undefined (reading 'replace')
    at /Users/jayden/code/boost-any/node_modules/drizzle-kit/bin.cjs:19501:39
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
```

如果你遇到了类似的报错，这一般是 supabase 的原因，可以尝试[https://github.com/drizzle-team/drizzle-orm/issues/3766#issuecomment-2547490079](https://github.com/drizzle-team/drizzle-orm/issues/3766#issuecomment-2547490079)
